import pytest, re, subprocess
from arp_spoofing.arp_spoofing import ArpSpoofing

def test_get_default_gateway():
  arp = ArpSpoofing()
  pattern = r'\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'

  default_gateway = arp.get_default_gateway()

  assert re.match(pattern, default_gateway)

def test_get_str_max_address():
  arp = ArpSpoofing()
  pattern = r'^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$'
  mac_address = arp.get_str_mac_addres()

  assert re.match(pattern, mac_address)

def test_get_interface():
  arp = ArpSpoofing()
  ifconfig = subprocess.check_output(["ifconfig"]).decode()
  interface = arp.get_interface()
  assert interface in ifconfig