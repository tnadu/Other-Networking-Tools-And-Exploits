import pytest


from dns.DNS_controller import DNSController
# from dns.statistics import Statistics
# import dns.blacklists
# import dns.main_DNS
# import dns.simple_flask
# import dns.dns_settings

from scapy.layers.dns import IP, UDP, DNS, DNSQR, DNSRR


class TestDns():
    @pytest.fixture
    @staticmethod
    def valid_requests():
        valid_requests: dict = {
            '192.36.148.17': {
                'www.google.com': DNSRR(rrname='www.google.com', type='A', rdata='142.250.185.142')
            }
            
        }

        return valid_requests


    @staticmethod
    def test_interpret_DNS_qtype():
        input: list = [1, 2, 5, 15, 28, 99]
        expected_output: list = ["A", "NS", "CNAME", "MX", "AAAA", "UNKNOWN"]
        assert all(DNSController.interpret_DNS_qtype(input[i]) == expected_output[i] for i in range(len(input)))